Task 1
SELECT СтранаОбитания, Болезнь1, Болезнь2, БолезньN
FROM
(SELECT ж.СтранаОбитания, бж.Название AS НазваниеБолезни, фб.IDФакта AS ФактБолезни
FROM ФактыБолезни фб JOIN Животные ж ON фб.IDЖивотного = ж.IDЖивотного
JOIN БолезниЖивотных бж ON фб.IDБолезни = бж.IDБолезни) AS SourceTable
PIVOT
(COUNT (ФактБолезни) FOR НазваниеБолезни IN (Болезнь1, Болезнь2, БолезньN)) AS PivotTable

Task 2
SELECT CAST (COUNT (DATEDIFF (DAY, ISNULL (ДатаВремяУборки, 0), ISNULL (ДатаВремяКормления, 0))) AS FLOAT) /
(SELECT CAST (COUNT (1) AS FLOAT)
FROM Уход) * 100 AS ПроцентКормленияДоУборки
FROM Уход
WHERE DATEDIFF (DAY, ISNULL (ДатаВремяУборки, 0), ISNULL (ДатаВремяКормления, 0)) < 0



